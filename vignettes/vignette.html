<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ryan Thompson" />


<title>Guide to familial</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Guide to familial</h1>
<h4 class="author">Ryan Thompson</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><code>familal</code> is an <code>R</code> package for testing familial hypotheses as described at [insert link to paper]. Briefly, familial hypotheses about a random variable <span class="math inline">\(X\)</span> are statements of the form: <span class="math display">\[
\begin{split}
&amp;\mathrm{H}_0:\mu(\lambda)=\mu_0\text{ for some }\lambda\in\Lambda \\
&amp;\mathrm{H}_1:\mu(\lambda)\neq\mu_0\text{ for all }\lambda\in\Lambda,
\end{split}
\]</span> where <span class="math inline">\(\{\mu(\lambda):\lambda\in\Lambda\}\)</span> is a family of population parameters.</p>
<p>Presently, <code>familial</code> supports tests for the centers of a distribution via the Huber or trimmed mean families of location parameters. The mean and median are members of both these families. The Huber loss function gives rise to the Huber family: <span class="math display">\[
\ell_\lambda(x,\mu):=
\begin{cases}
\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2 &amp; \text{if } \left|\frac{x-\mu}{\sigma}\right|\leq\lambda \\
\lambda\left|\frac{x-\mu}{\sigma}\right|-\frac{1}{2}\lambda^2 &amp; \text{otherwise},
\end{cases}
\]</span> where <span class="math inline">\(\lambda\in\Lambda=(0,\infty)\)</span> and <span class="math inline">\(\sigma\)</span> is the scale of <span class="math inline">\(X\)</span>. In this case, the familial null hypothesis reads as ‘there exists a <span class="math inline">\(\lambda\)</span> such that <span class="math inline">\(\mu(\lambda)\)</span>, the population minimizer of the Huber loss function with indexing parameter <span class="math inline">\(\lambda\)</span>, is equal to <span class="math inline">\(\mu_0\)</span>.’ The symmetrically trimmed square loss function gives rise to the trimmed mean family: <span class="math display">\[
\ell_\lambda(x,\mu):=
\begin{cases}
\frac{1}{2}(x-\mu)^2 &amp; \text{if } \lambda&lt;F(x)&lt;1-\lambda \\
0 &amp; \text{otherwise},
\end{cases}
\]</span> where <span class="math inline">\(\lambda\in\Lambda=[0,0.5)\)</span> and <span class="math inline">\(F\)</span> is the cumulative distribution function of <span class="math inline">\(X\)</span>. The null hypothesis is analogous to that for Huber loss.</p>
<p>The sample counterpart of the parameter <span class="math inline">\(\mu(\lambda)\)</span> is given by <span class="math display">\[
\hat{\mu}(\lambda):=\underset{\mu}{\operatorname{arg~min}}\sum_{i=1}^n\ell_\lambda(x_i,\mu).
\]</span> <code>familial</code> contains algorithms for solving this minimization for all values of <span class="math inline">\(\lambda\)</span> with both of the above loss functions. Consider the brain-to-body weight ratio of mammals in the <code>mammals</code> dataset from the <code>MASS</code> package. The Huber family is a path that goes from the median at the far left to the mean at the far right.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(familial)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> MASS<span class="sc">::</span>mammals<span class="sc">$</span>brain <span class="sc">/</span> MASS<span class="sc">::</span>mammals<span class="sc">$</span>body</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fit.family</span>(x, <span class="at">family =</span> <span class="st">&#39;huber&#39;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now, to test familial hypotheses, <code>familial</code> uses the Bayesian bootstrap. Specifically, to bootstrap <span class="math inline">\(\hat{\mu}(\lambda)\)</span>, we draw weights <span class="math inline">\(w_1^{(b)},\ldots,w_n^{(b)}\)</span> (<span class="math inline">\(b=1,\ldots,B\)</span>) from a uniform Dirichlet distribution and solve <span class="math display">\[
\hat{\mu}^{(b)}(\lambda):=\underset{\mu}{\operatorname{arg~min}}\sum_{i=1}^nw_i^{(b)}\ell_\lambda(x_i,\mu).
\]</span> We solve the above minimization for all values of <span class="math inline">\(\lambda\)</span> for <span class="math inline">\(b=1,\ldots,B\)</span> and measure the proportions of time that the family contains the null value <span class="math inline">\(\mu_0\)</span>. This proportion represents the posterior probability of <span class="math inline">\(H_0\)</span> being true. To map this probability to a decision (accept, reject, or indeterminate), we assign a loss to making an incorrect decision. The decision that minimizes the expected loss under the posterior distribution is the optimal one.</p>
</div>
<div id="one-sample-tests" class="section level2">
<h2>One-sample tests</h2>
<p>Let’s demonstrate the functionality of <code>familial</code>. To perform a test of centers with the Huber family, use the <code>center.test</code> function with argument <code>family=&#39;huber&#39;</code> (the default setting). We’ll test whether the velocity of galaxies in the <code>galaxies</code> dataset is different to 21,000 km/sec.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> MASS<span class="sc">::</span>galaxies</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">center.test</span>(x, <span class="at">mu =</span> <span class="dv">21000</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; familial test of centers with huber family</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu = 21000 </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; posterior probabilities: </span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    H0    H1 </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.542 0.458 </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; optimal decision: indeterminate</span></span></code></pre></div>
<p>The output above shows the posterior probabilities for the events <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>. The 54.2% probability assigned to <span class="math inline">\(H_0\)</span> means that the Huber family contained a center equal to 21,000 km/sec in 54.2% of bootstraps. Because neither of the above probabilities is much larger than the other, the test results in an indeterminate outcome. By default, the function will return an indeterminate result when neither <span class="math inline">\(H_0\)</span> nor <span class="math inline">\(H_1\)</span> have probability at least 0.95. This choice of threshold is analogous to using a frequentist significance level of 0.05.</p>
<p>It is also possible to produce a functional boxplot of the posterior using the <code>plot</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(test)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Using alpha for a discrete variable is not advised.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Rather than specify a null value that is a point, we can specify the null as an interval. Let’s now test whether the velocity is between 20,500 km/sec and 21,500 km/sec.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">center.test</span>(x, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">20500</span>, <span class="dv">21500</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; familial test of centers with huber family</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu = 20500 21500 </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; posterior probabilities: </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    H0    H1 </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.959 0.041 </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; optimal decision: H0</span></span></code></pre></div>
<p>The test now accepts <span class="math inline">\(H_0\)</span>.</p>
</div>
<div id="two-sample-tests" class="section level2">
<h2>Two-sample tests</h2>
<p><code>familial</code> also supports two-sample testing with paired or independent samples. We’ll now test whether the weight of cabbages in the <code>cabbages</code> dataset is different between two different cultivars. These samples are independent, so we set <code>paired = FALSE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> MASS<span class="sc">::</span>cabbages[MASS<span class="sc">::</span>cabbages<span class="sc">$</span>Cult <span class="sc">==</span> <span class="st">&#39;c39&#39;</span>, <span class="st">&#39;HeadWt&#39;</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> MASS<span class="sc">::</span>cabbages[MASS<span class="sc">::</span>cabbages<span class="sc">$</span>Cult <span class="sc">==</span> <span class="st">&#39;c52&#39;</span>, <span class="st">&#39;HeadWt&#39;</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">center.test</span>(x, y, <span class="at">paired =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; familial test of centers with huber family</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu = 0 </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; posterior probabilities: </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    H0    H1 </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.009 0.991 </span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; optimal decision: H1</span></span></code></pre></div>
<p>The test rejects <span class="math inline">\(H_0\)</span> that the weight of cabbages is the same.</p>
<p>We can also visualize the posterior differences between the family of each cultivar via a functional boxplot.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(test)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Using alpha for a discrete variable is not advised.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><code>familial</code> also supports one-sided tests. Let’s test whether family treatment (FT) improves the weight of anorexia patients in the <code>anorexia</code> dataset. These samples are paired.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> MASS<span class="sc">::</span>anorexia[MASS<span class="sc">::</span>anorexia<span class="sc">$</span>Treat <span class="sc">==</span> <span class="st">&#39;FT&#39;</span>, <span class="st">&#39;Postwt&#39;</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> MASS<span class="sc">::</span>anorexia[MASS<span class="sc">::</span>anorexia<span class="sc">$</span>Treat <span class="sc">==</span> <span class="st">&#39;FT&#39;</span>, <span class="st">&#39;Prewt&#39;</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">center.test</span>(x, y, <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; familial test of centers with huber family</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -----------------------------------------------</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu = 0 </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; posterior probabilities: </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    H0    H1 </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.006 0.994 </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; optimal decision: H1</span></span></code></pre></div>
<p>We again reject <span class="math inline">\(H_0\)</span> that FT does not improve the weight of patients.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
